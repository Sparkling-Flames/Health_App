{"version":3,"file":"diet.js","sources":["pages/diet/diet.vue","../../../hbuilderX/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZGlldC9kaWV0LnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"p-3\">\r\n    <view class=\"card\">\r\n      <text>今日摄入热量：{{ total }} kcal</text>\r\n    </view>\r\n    <view class=\"mt-2 card\">\r\n      <input v-model=\"food\" placeholder=\"食物名称\" />\r\n      <input v-model.number=\"calories\" type=\"number\" placeholder=\"热量(kcal)\" />\r\n      <button class=\"mt-2\" @click=\"addDiet\">添加</button>\r\n    </view>\r\n    <view class=\"mt-2 card\" v-for=\"item in list\" :key=\"item._id\">\r\n      <view>{{ item.food }} - {{ item.calories }} kcal</view>\r\n    </view>\r\n  </view>\r\n</template>\r\n<script setup>\r\nimport { ref, computed } from 'vue'\r\nimport { onShow } from '@dcloudio/uni-app'\r\nimport { dietService } from '../../services/api.js'\r\n\r\nconst food = ref('')\r\nconst calories = ref(0)\r\nconst list = ref([])\r\n\r\nconst total = computed(() =>\r\n  list.value.reduce((sum, item) => sum + Number(item.calories || 0), 0)\r\n)\r\n\r\nconst load = async () => {\r\n  const today = new Date().toISOString().slice(0, 10)\r\n  try {\r\n    const res = await dietService.dailyDiet(today)\r\n    list.value = res.records || []\r\n  } catch (e) {\r\n    console.error(e)\r\n  }\r\n}\r\n\r\nconst addDiet = async () => {\r\n  if (!food.value || !calories.value) {\r\n    uni.showToast({ title: '请填写完整', icon: 'none' })\r\n    return\r\n  }\r\n  try {\r\n    await dietService.addDiet({\r\n      food: food.value,\r\n      calories: Number(calories.value),\r\n      date: new Date().toISOString().slice(0, 10)\r\n    })\r\n    food.value = ''\r\n    calories.value = 0\r\n    await load()\r\n  } catch (e) {\r\n    console.error(e)\r\n  }\r\n}\r\n\r\nonShow(load)\r\n</script>\r\n<style scoped>\r\ninput{border:1px solid #eee;padding:12rpx;border-radius:8rpx;margin-top:12rpx}\r\nbutton{background:#1afa29;color:#fff;padding:16rpx;border-radius:8rpx;}\r\n</style>\r\n","import MiniProgramPage from 'D:/Work/unicode/health_app/pages/diet/diet.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","computed","dietService","uni","onShow"],"mappings":";;;;;;AAoBA,UAAM,OAAOA,cAAG,IAAC,EAAE;AACnB,UAAM,WAAWA,cAAG,IAAC,CAAC;AACtB,UAAM,OAAOA,cAAG,IAAC,EAAE;AAEnB,UAAM,QAAQC,cAAAA;AAAAA,MAAS,MACrB,KAAK,MAAM,OAAO,CAAC,KAAK,SAAS,MAAM,OAAO,KAAK,YAAY,CAAC,GAAG,CAAC;AAAA,IACtE;AAEA,UAAM,OAAO,YAAY;AACvB,YAAM,SAAQ,oBAAI,KAAM,GAAC,YAAW,EAAG,MAAM,GAAG,EAAE;AAClD,UAAI;AACF,cAAM,MAAM,MAAMC,yBAAY,UAAU,KAAK;AAC7C,aAAK,QAAQ,IAAI,WAAW,CAAE;AAAA,MAC/B,SAAQ,GAAG;AACVC,sBAAAA,MAAc,MAAA,SAAA,6BAAA,CAAC;AAAA,MAChB;AAAA,IACH;AAEA,UAAM,UAAU,YAAY;AAC1B,UAAI,CAAC,KAAK,SAAS,CAAC,SAAS,OAAO;AAClCA,sBAAG,MAAC,UAAU,EAAE,OAAO,SAAS,MAAM,QAAQ;AAC9C;AAAA,MACD;AACD,UAAI;AACF,cAAMD,aAAAA,YAAY,QAAQ;AAAA,UACxB,MAAM,KAAK;AAAA,UACX,UAAU,OAAO,SAAS,KAAK;AAAA,UAC/B,OAAM,oBAAI,QAAO,YAAa,EAAC,MAAM,GAAG,EAAE;AAAA,QAChD,CAAK;AACD,aAAK,QAAQ;AACb,iBAAS,QAAQ;AACjB,cAAM,KAAM;AAAA,MACb,SAAQ,GAAG;AACVC,sBAAAA,MAAc,MAAA,SAAA,6BAAA,CAAC;AAAA,MAChB;AAAA,IACH;AAEAC,kBAAM,OAAC,IAAI;;;;;;;;;;;;;;;;;;;;;;;ACxDX,GAAG,WAAW,eAAe;"}