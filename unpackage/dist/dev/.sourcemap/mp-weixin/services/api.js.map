{"version":3,"file":"api.js","sources":["services/api.js"],"sourcesContent":["// 基础云函数/HTTP调用封装\r\n// 可在 HBuilderX 中替换为 uniCloud.callFunction 或 uni.request\r\nexport function callApi({ api, data = {}, loading = false }) {\r\n  // 占位：统一错误处理/Loading\r\n  if (loading) uni.showLoading({ title: '加载中' })\r\n  return new Promise((resolve, reject) => {\r\n    uniCloud.callFunction({\r\n      name: 'fun',\r\n      data: { api, args: data }\r\n    }).then(res => {\r\n      if (loading) uni.hideLoading()\r\n      if (res.result && res.result.success) {\r\n        resolve(res.result.data)\r\n      } else {\r\n        uni.showToast({ title: res.result?.errorMessage || '错误', icon: 'none' })\r\n        reject(res.result?.errorMessage)\r\n      }\r\n    }).catch(err => {\r\n      if (loading) uni.hideLoading()\r\n      uni.showToast({ title: '网络错误', icon: 'none' })\r\n      reject(err)\r\n    })\r\n  })\r\n}\r\n\r\nexport const groupService = {\r\n  getMyGroup() { return callApi({ api: 'getMyGroup' }) },\r\n  listGroups() { return callApi({ api: 'getManyGroup', loading: true }) },\r\n  createGroup(form) { return callApi({ api: 'createGroup', data: form, loading: true }) },\r\n  joinGroup(form) { return callApi({ api: 'joinGroup', data: form, loading: true }) },\r\n  groupMembers(groupId) { return callApi({ api: 'getManyForm', data: { groupId }, loading: true }) }\r\n}\r\n\r\nexport const messageService = {\r\n  listPublic() {\r\n    return callApi({ api: 'message', data: { action: 'list' }, loading: true })\r\n  },\r\n  publish(content) {\r\n    return callApi({\r\n      api: 'message',\r\n      data: { action: 'publish', content },\r\n      loading: true\r\n    })\r\n  }\r\n}\r\n\r\nexport const dietService = {\r\n  addDiet(record) {\r\n    return callApi({ api: 'diet', data: record })\r\n  },\r\n  dailyDiet(date) {\r\n    return callApi({ api: 'diet', data: { date }, loading: true })\r\n  }\r\n}\r\n\r\nexport const sportService = {\r\n  addSport(record) {\r\n    return callApi({ api: 'sport', data: record })\r\n  },\r\n  dailySport(date) {\r\n    return callApi({ api: 'sport', data: { date }, loading: true })\r\n  }\r\n}\r\n\r\nexport const reportService = {\r\n  generate(dateRange) {\r\n    return callApi({ api: 'report', data: dateRange, loading: true })\r\n  },\r\n  aiSummary(reportId) {\r\n    return callApi({ api: 'aiSummary', data: { reportId }, loading: true })\r\n  }\r\n}\r\n"],"names":["uni","uniCloud"],"mappings":";;AAEO,SAAS,QAAQ,EAAE,KAAK,OAAO,CAAA,GAAI,UAAU,SAAS;AAE3D,MAAI;AAASA,kBAAAA,MAAI,YAAY,EAAE,OAAO,MAAK,CAAE;AAC7C,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtCC,kBAAAA,GAAS,aAAa;AAAA,MACpB,MAAM;AAAA,MACN,MAAM,EAAE,KAAK,MAAM,KAAM;AAAA,IAC/B,CAAK,EAAE,KAAK,SAAO;;AACb,UAAI;AAASD,sBAAG,MAAC,YAAa;AAC9B,UAAI,IAAI,UAAU,IAAI,OAAO,SAAS;AACpC,gBAAQ,IAAI,OAAO,IAAI;AAAA,MAC/B,OAAa;AACLA,4BAAI,UAAU,EAAE,SAAO,SAAI,WAAJ,mBAAY,iBAAgB,MAAM,MAAM,QAAQ;AACvE,gBAAO,SAAI,WAAJ,mBAAY,YAAY;AAAA,MAChC;AAAA,IACP,CAAK,EAAE,MAAM,SAAO;AACd,UAAI;AAASA,sBAAG,MAAC,YAAa;AAC9BA,oBAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,QAAQ;AAC7C,aAAO,GAAG;AAAA,IAChB,CAAK;AAAA,EACL,CAAG;AACH;AAEY,MAAC,eAAe;AAAA,EAC1B,aAAa;AAAE,WAAO,QAAQ,EAAE,KAAK,aAAc,CAAA;AAAA,EAAG;AAAA,EACtD,aAAa;AAAE,WAAO,QAAQ,EAAE,KAAK,gBAAgB,SAAS,KAAI,CAAE;AAAA,EAAG;AAAA,EACvE,YAAY,MAAM;AAAE,WAAO,QAAQ,EAAE,KAAK,eAAe,MAAM,MAAM,SAAS,KAAM,CAAA;AAAA,EAAG;AAAA,EACvF,UAAU,MAAM;AAAE,WAAO,QAAQ,EAAE,KAAK,aAAa,MAAM,MAAM,SAAS,KAAM,CAAA;AAAA,EAAG;AAAA,EACnF,aAAa,SAAS;AAAE,WAAO,QAAQ,EAAE,KAAK,eAAe,MAAM,EAAE,QAAS,GAAE,SAAS,KAAM,CAAA;AAAA,EAAG;AACpG;AAEY,MAAC,iBAAiB;AAAA,EAC5B,aAAa;AACX,WAAO,QAAQ,EAAE,KAAK,WAAW,MAAM,EAAE,QAAQ,OAAQ,GAAE,SAAS,MAAM;AAAA,EAC3E;AAAA,EACD,QAAQ,SAAS;AACf,WAAO,QAAQ;AAAA,MACb,KAAK;AAAA,MACL,MAAM,EAAE,QAAQ,WAAW,QAAS;AAAA,MACpC,SAAS;AAAA,IACf,CAAK;AAAA,EACF;AACH;AAEY,MAAC,cAAc;AAAA,EACzB,QAAQ,QAAQ;AACd,WAAO,QAAQ,EAAE,KAAK,QAAQ,MAAM,OAAM,CAAE;AAAA,EAC7C;AAAA,EACD,UAAU,MAAM;AACd,WAAO,QAAQ,EAAE,KAAK,QAAQ,MAAM,EAAE,KAAM,GAAE,SAAS,MAAM;AAAA,EAC9D;AACH;AAEY,MAAC,eAAe;AAAA,EAC1B,SAAS,QAAQ;AACf,WAAO,QAAQ,EAAE,KAAK,SAAS,MAAM,OAAM,CAAE;AAAA,EAC9C;AAAA,EACD,WAAW,MAAM;AACf,WAAO,QAAQ,EAAE,KAAK,SAAS,MAAM,EAAE,KAAM,GAAE,SAAS,MAAM;AAAA,EAC/D;AACH;AAEY,MAAC,gBAAgB;AAAA,EAC3B,SAAS,WAAW;AAClB,WAAO,QAAQ,EAAE,KAAK,UAAU,MAAM,WAAW,SAAS,MAAM;AAAA,EACjE;AAAA,EACD,UAAU,UAAU;AAClB,WAAO,QAAQ,EAAE,KAAK,aAAa,MAAM,EAAE,SAAU,GAAE,SAAS,MAAM;AAAA,EACvE;AACH;;;;;;"}